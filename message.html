<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Olinsterg College Feedback & Admin</title>

<style>
/* GLOBAL STYLE */
* {margin:0; padding:0; box-sizing:border-box; font-family:Arial,sans-serif;}
body, html {height:100%; background:#001a33; color:#fff;}

/* ANIMATED BACKGROUND */
body::before {
    content:"";
    position:fixed; top:0; left:0; width:100%; height:100%;
    background: linear-gradient(270deg, #001a33, #003366, #001a33, #0055a5);
    background-size: 800% 800%;
    z-index:-1;
    animation: gradientMove 20s ease infinite;
}
@keyframes gradientMove {
    0% {background-position:0% 50%;}
    50% {background-position:100% 50%;}
    100% {background-position:0% 50%;}
}

header {text-align:center; padding:25px; text-shadow:0 0 10px #00d4ff,0 0 20px #00ffff;}
header h1 {font-size:36px; color:#00e5ff;}
header p {color:#80e0ff; font-size:16px;}

.container {width:90%; max-width:1000px; margin:20px auto;}

h2 {text-align:center; color:#00ffff; font-size:28px; margin-bottom:15px; text-shadow:0 0 10px #00ffff,0 0 20px #00d4ff;}

.feedback-form {background: rgba(0,51,102,0.8); padding: 20px; border-radius: 12px; box-shadow:0 0 15px #00d4ff; margin-bottom:30px;}
.feedback-form input, .feedback-form textarea {width:100%; padding:10px; margin:10px 0; border-radius:5px; border:none; font-size:15px;}
.feedback-form button {padding:10px 20px; border-radius:5px; border:none; background:#00d4ff; color:#001a33; cursor:pointer; font-weight:bold;}
.feedback-form button:hover {background:#00ffff;}

.messages-box {
    background: rgba(0,51,102,0.8);
    padding: 20px;
    border-radius: 12px;
    box-shadow:0 0 15px #00d4ff;
    max-height: 60vh;
    overflow-y: auto;
}

.message {
    border-bottom: 1px solid #00d4ff;
    padding: 10px 0;
}

.message:last-child {border-bottom:none;}
.message h3 {color:#00ffff; margin-bottom:5px; font-size:18px;}
.message p {color:#ccefff; margin-bottom:5px; font-size:15px;}
.message em {color:#80e0ff; font-size:13px;}

.actions {margin-top: 15px; text-align:center;}
.actions button {
    display:inline-block;
    margin:5px;
    color: #00d4ff;
    background: rgba(0,0,0,0.3);
    border:none;
    padding:10px 20px;
    border-radius:8px;
    font-weight:bold;
    cursor:pointer;
    box-shadow:0 0 10px #00d4ff;
}
.actions button:hover {background: rgba(0,255,255,0.2); color:#00ffff;}

.messages-box::-webkit-scrollbar {
    width: 8px;
}
.messages-box::-webkit-scrollbar-thumb {
    background: #00d4ff;
    border-radius: 4px;
}
.messages-box::-webkit-scrollbar-track {
    background: rgba(0,51,102,0.3);
}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

</head>
<body>

<header>
    <h1>Olinsterg College Digital Map</h1>
    <p>Feedback & Admin Messages</p>
</header>

<div class="container">

    <!-- FEEDBACK FORM -->
    <h2>Submit Feedback</h2>
    <div class="feedback-form">
        <input type="text" id="name" placeholder="Your Name" required>
        <input type="email" id="email" placeholder="Your Email" required>
        <textarea id="message" placeholder="Your Message" rows="4" required></textarea>
        <button onclick="sendMessage()">Send Message</button>
    </div>

    <!-- MESSAGES -->
    <h2>User Feedback Messages</h2>
    <div class="messages-box" id="messagesBox">
        <p style='text-align:center; color:#80e0ff;'>Loading messages...</p>
    </div>

    <div class="actions">
        <button onclick="clearMessages()">ðŸ—‘ Clear All Messages</button>
    </div>

</div>

<script>
// ====== Firebase Config ======
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "olinstergmapv2.firebaseapp.com",
  databaseURL: "https://olinstergmapv2-default-rtdb.firebaseio.com",
  projectId: "olinstergmapv2",
  storageBucket: "olinstergmapv2.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ====== SEND MESSAGE FUNCTION ======
function sendMessage(){
    const name = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const message = document.getElementById('message').value.trim();

    if(!name || !email || !message){
        alert("Please fill in all fields.");
        return;
    }

    const newMessageRef = db.ref('messages').push();
    newMessageRef.set({
        name: name,
        email: email,
        message: message,
        date: new Date().toLocaleString(),
        timestamp: Date.now()
    }, (error)=>{
        if(error){
            alert("Error sending message. Try again.");
        } else {
            alert("Message sent successfully!");
            document.getElementById('name').value="";
            document.getElementById('email').value="";
            document.getElementById('message').value="";
        }
    });
}

// ====== DISPLAY MESSAGES IN REALTIME ======
const messagesBox = document.getElementById('messagesBox');
function displayMessages(messages){
    if(!messages){
        messagesBox.innerHTML = "<p style='text-align:center; color:#80e0ff;'>No messages yet.</p>";
        return;
    }

    // Sort newest first
    const messagesArray = Object.entries(messages).sort((a,b) => b[1].timestamp - a[1].timestamp);

    messagesBox.innerHTML = messagesArray.map(([key,msg]) => `
        <div class="message">
            <h3>${msg.name} (${msg.email})</h3>
            <p>${msg.message}</p>
            <em>${msg.date}</em>
        </div>
    `).join('');
}

// Realtime listener
db.ref('messages').on('value', snapshot => {
    displayMessages(snapshot.val());
});

// ====== CLEAR ALL MESSAGES ======
function clearMessages(){
    if(confirm("Are you sure you want to delete all feedback messages?")){
        db.ref('messages').remove();
        alert("All feedback messages have been cleared.");
    }
}
</script>

</body>
</html>
